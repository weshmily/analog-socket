(()=>{var e={145:(e,t,r)=>{"use strict";var o=r(837),i=r(361),s=r(113),n=r(314),a=r(198),h=r(699),c=r(243);function f(e,t,r){var o,s=this;t instanceof c?(this.server=t,this.path=null,this.host=null,this.extraHeaders=null,this.protocols=[]):(this.server=null,this.path=t.path,this.host=t.host,this.extraHeaders=t.extraHeaders,this.protocols=t.protocols||[]),this.protocol=void 0,this.socket=e,this.readyState=this.CONNECTING,this.buffer=Buffer.alloc(0),this.frameBuffer=null,this.outStream=null,this.key=null,this.headers={},e.on("readable",(function(){s.doRead()})),e.on("error",(function(e){s.emit("error",e)})),this.server||(o="CleartextStream"===e.constructor.name?"secureConnect":"connect",e.on(o,(function(){s.startHandshake()})));var h=function(){s.readyState!==s.CONNECTING&&s.readyState!==s.OPEN||s.emit("close",1006,""),s.readyState=this.CLOSED,s.frameBuffer instanceof n&&(s.frameBuffer.end(),s.frameBuffer=null),s.outStream instanceof a&&(s.outStream.end(),s.outStream=null)};e.once("close",h),e.once("finish",h),i.EventEmitter.call(this),r&&this.once("connect",r)}o.inherits(f,i.EventEmitter),e.exports=f,f.binaryFragmentation=524288,f.maxBufferLength=2097152,f.prototype.CONNECTING=0,f.prototype.OPEN=1,f.prototype.CLOSING=2,f.prototype.CLOSED=3,f.prototype.sendText=function(e,t){if(this.readyState===this.OPEN){if(!this.outStream)return this.socket.write(h.createTextFrame(e,!this.server),t);this.emit("error",new Error("You can't send a text frame until you finish sending binary frames"))}else this.emit("error",new Error("You can't write to a non-open connection"))},f.prototype.beginBinary=function(){if(this.readyState===this.OPEN){if(!this.outStream)return this.outStream=new a(this,f.binaryFragmentation);this.emit("error",new Error("You can't send more binary frames until you finish sending the previous binary frames"))}else this.emit("error",new Error("You can't write to a non-open connection"))},f.prototype.sendBinary=function(e,t){if(this.readyState===this.OPEN){if(!this.outStream)return this.socket.write(h.createBinaryFrame(e,!this.server,!0,!0),t);this.emit("error",new Error("You can't send more binary frames until you finish sending the previous binary frames"))}else this.emit("error",new Error("You can't write to a non-open connection"))},f.prototype.send=function(e,t){if("string"==typeof e)this.sendText(e,t);else{if(!Buffer.isBuffer(e))throw new TypeError("data should be either a string or a Buffer instance");this.sendBinary(e,t)}},f.prototype.sendPing=function(e){this.readyState===this.OPEN?this.socket.write(h.createPingFrame(e||"",!this.server)):this.emit("error",new Error("You can't write to a non-open connection"))},f.prototype.close=function(e,t){this.readyState===this.OPEN?(this.socket.write(h.createCloseFrame(e,t,!this.server)),this.readyState=this.CLOSING):this.readyState!==this.CLOSED&&(this.socket.end(),this.readyState=this.CLOSED),this.emit("close",e,t)},f.prototype.doRead=function(){var e,t;if((e=this.socket.read())&&(this.buffer=Buffer.concat([this.buffer,e],this.buffer.length+e.length),(this.readyState!==this.CONNECTING||this.readHandshake())&&this.readyState!==this.CLOSED)){for(;!0===(t=this.extractFrame()););!1===t?this.close(1002):this.buffer.length>f.maxBufferLength&&this.close(1009)}},f.prototype.startHandshake=function(){var e,t,r,o,i;for(r=Buffer.alloc(16),t=0;t<16;t++)r[t]=Math.floor(256*Math.random());for(i in this.key=r.toString("base64"),o={Host:this.host,Upgrade:"websocket",Connection:"Upgrade","Sec-WebSocket-Key":this.key,"Sec-WebSocket-Version":"13"},this.protocols&&this.protocols.length&&(o["Sec-WebSocket-Protocol"]=this.protocols.join(", ")),this.extraHeaders)o[i]=this.extraHeaders[i];e=this.buildRequest("GET "+this.path+" HTTP/1.1",o),this.socket.write(e)},f.prototype.readHandshake=function(){var e,t,r=!1;if(this.buffer.length>f.maxBufferLength)return this.server?this.socket.end("HTTP/1.1 400 Bad Request\r\n\r\n"):(this.socket.end(),this.emit("error",new Error("Handshake is too big"))),!1;for(e=0;e<this.buffer.length-3;e++)if(13===this.buffer[e]&&13===this.buffer[e+2]&&10===this.buffer[e+1]&&10===this.buffer[e+3]){r=!0;break}return!!r&&(t=this.buffer.slice(0,e+4).toString().split("\r\n"),(this.server?this.answerHandshake(t):this.checkHandshake(t))?(this.buffer=this.buffer.slice(e+4),this.readyState=this.OPEN,this.emit("connect"),!0):(this.socket.end(this.server?"HTTP/1.1 400 Bad Request\r\n\r\n":void 0),!1))},f.prototype.readHeaders=function(e){var t,r;for(t=1;t<e.length;t++)(r=e[t].match(/^([a-z-]+): (.+)$/i))&&(this.headers[r[1].toLowerCase()]=r[2])},f.prototype.checkHandshake=function(e){var t,r,o;if(e.length<4)return this.emit("error",new Error("Invalid handshake: too short")),!1;if(!e[0].match(/^HTTP\/\d\.\d 101( .*)?$/i))return this.emit("error",new Error("Invalid handshake: invalid first line format")),!1;if(this.readHeaders(e),!("upgrade"in this.headers)||!("sec-websocket-accept"in this.headers)||!("connection"in this.headers))return this.emit("error",new Error("Invalid handshake: missing required headers")),!1;if("websocket"!==this.headers.upgrade.toLowerCase()||-1===this.headers.connection.toLowerCase().split(/\s*,\s*/).indexOf("upgrade"))return this.emit("error",new Error("Invalid handshake: invalid Upgrade or Connection header")),!1;if(t=this.headers["sec-websocket-accept"],o=this.headers["sec-websocket-protocol"],this.protocols&&this.protocols.length){if(!o||-1===this.protocols.indexOf(o))return this.emit("error",new Error("Invalid handshake: no protocol was negotiated")),!1}else if(o)return this.emit("error",new Error("Invalid handshake: no protocol negotiation was expected")),!1;return this.protocol=o,(r=s.createHash("sha1")).end(this.key+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11"),t===r.read().toString("base64")||(this.emit("error",new Error("Invalid handshake: hash mismatch")),!1)},f.prototype.answerHandshake=function(e){var t,r,o;return!(e.length<6)&&!!(t=e[0].match(/^GET (.+) HTTP\/\d\.\d$/i))&&(this.path=t[1],this.readHeaders(e),"host"in this.headers&&"sec-websocket-key"in this.headers&&"upgrade"in this.headers&&"connection"in this.headers&&"websocket"===this.headers.upgrade.toLowerCase()&&-1!==this.headers.connection.toLowerCase().split(/\s*,\s*/).indexOf("upgrade")&&"13"===this.headers["sec-websocket-version"]&&(this.key=this.headers["sec-websocket-key"],"sec-websocket-protocol"in this.headers&&(this.protocols=this.headers["sec-websocket-protocol"].split(",").map((function(e){return e.trim()})),this.server._selectProtocol&&(this.protocol=this.server._selectProtocol(this,this.protocols))),(r=s.createHash("sha1")).end(this.key+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11"),o={Upgrade:"websocket",Connection:"Upgrade","Sec-WebSocket-Accept":r.read().toString("base64")},this.protocol&&(o["Sec-WebSocket-Protocol"]=this.protocol),this.socket.write(this.buildRequest("HTTP/1.1 101 Switching Protocols",o)),!0))},f.prototype.extractFrame=function(){var e,t,r,o,i,s,n,a,h,c;if(!(this.buffer.length<2)){if((o=(r=this.buffer[0])>>4)%8)return!1;if(e=8===o,0!=(t=r%16)&&1!==t&&2!==t&&8!==t&&9!==t&&10!==t)return!1;if(t>=8&&!e)return!1;if(c=(r=this.buffer[1])>>7,this.server&&!c||!this.server&&c)return!1;if(s=r%128,a=c?6:2,!(this.buffer.length<a+s||(126===s?(s=this.buffer.readUInt16BE(2),a+=2):127===s&&(s=this.buffer.readUInt32BE(2)*Math.pow(2,32)+this.buffer.readUInt32BE(6),a+=8),this.buffer.length<a+s))){if(n=this.buffer.slice(a,a+s),c)for(i=this.buffer.slice(a-4,a),h=0;h<n.length;h++)n[h]^=i[h%4];return this.buffer=this.buffer.slice(a+s),this.processFrame(e,t,n)}}},f.prototype.processFrame=function(e,t,r){return 8===t?(this.readyState===this.CLOSING?this.socket.end():this.readyState===this.OPEN&&this.processCloseFrame(r),!0):9===t?(this.readyState===this.OPEN&&this.socket.write(h.createPongFrame(r.toString(),!this.server)),!0):10===t?(this.emit("pong",r.toString()),!0):this.readyState!==this.OPEN||(0!==t||null!==this.frameBuffer)&&(0===t||null===this.frameBuffer)&&(t||(t="string"==typeof this.frameBuffer?1:2),1===t?(r=r.toString(),this.frameBuffer=this.frameBuffer?this.frameBuffer+r:r,e&&(this.emit("text",this.frameBuffer),this.frameBuffer=null)):(this.frameBuffer||(this.frameBuffer=new n,this.emit("binary",this.frameBuffer)),this.frameBuffer.addData(r),e&&(this.frameBuffer.end(),this.frameBuffer=null)),!0)},f.prototype.processCloseFrame=function(e){var t,r;e.length>=2?(t=e.readUInt16BE(0),r=e.slice(2).toString()):(t=1005,r=""),this.socket.write(h.createCloseFrame(t,r,!this.server)),this.readyState=this.CLOSED,this.emit("close",t,r)},f.prototype.buildRequest=function(e,t){var r,o=e+"\r\n";for(r in t)o+=r+": "+t[r]+"\r\n";return o+"\r\n"}},314:(e,t,r)=>{"use strict";var o=r(837),i=r(781);function s(){i.Readable.call(this)}e.exports=s,o.inherits(s,i.Readable),s.prototype._read=function(){},s.prototype.addData=function(e){this.push(e)},s.prototype.end=function(){this.push(null)}},198:(e,t,r)=>{"use strict";var o=r(837),i=r(781),s=r(699);function n(e,t){var r=this;this.connection=e,this.minSize=t,this.buffer=Buffer.alloc(0),this.hasSent=!1,i.Writable.call(this),this.on("finish",(function(){r.connection.readyState===r.connection.OPEN&&r.connection.socket.write(s.createBinaryFrame(r.buffer,!r.connection.server,!r.hasSent,!0)),r.connection.outStream=null}))}e.exports=n,o.inherits(n,i.Writable),n.prototype._write=function(e,t,r){var o;this.buffer=Buffer.concat([this.buffer,e],this.buffer.length+e.length),this.buffer.length>=this.minSize?(this.connection.readyState===this.connection.OPEN&&(o=s.createBinaryFrame(this.buffer,!this.connection.server,!this.hasSent,!1),this.connection.socket.write(o,t,r)),this.buffer=Buffer.alloc(0),this.hasSent=!0,this.connection.readyState!==this.connection.OPEN&&r()):r()}},243:(e,t,r)=>{"use strict";function o(){}var i,s=r(837),n=r(808),a=r(404),h=r(361);function c(e,t,r){var s=this;"function"==typeof t&&(r=t,t=void 0);var c=function(e){var t=new i(e,s,(function(){s.connections.push(t),t.removeListener("error",o),s.emit("connection",t)}));t.on("close",(function(){var e=s.connections.indexOf(t);-1!==e&&s.connections.splice(e,1)})),t.on("error",o)};this.socket=e?a.createServer(t,c):n.createServer(t,c),this.socket.on("close",(function(){s.emit("close")})),this.socket.on("error",(function(e){s.emit("error",e)})),this.connections=[],h.EventEmitter.call(this),r&&this.on("connection",r),this._selectProtocol=null,t&&t.selectProtocol?this._selectProtocol=t.selectProtocol:t&&t.validProtocols&&(this._selectProtocol=this._buildSelectProtocol(t.validProtocols))}s.inherits(c,h.EventEmitter),e.exports=c,i=r(145),c.prototype.listen=function(e,t,r){var o=this;return"function"==typeof t&&(r=t,t=void 0),r&&this.on("listening",r),this.socket.listen(e,t,(function(){o.emit("listening")})),this},c.prototype.close=function(e){e&&this.once("close",e),this.socket.close()},c.prototype._buildSelectProtocol=function(e){return function(t,r){var o;for(o=0;o<r.length;o++)if(-1!==e.indexOf(r[o]))return r[o]}}},699:(e,t)=>{"use strict";function r(e,t,r,o){var i,s,n,a,h;if(i=o.length,(s=Buffer.alloc(2+(i<126?0:i<65536?2:8)+(r?4:0)))[0]=(e?128:0)+t,s[1]=r?128:0,n=2,i<126?s[1]+=i:i<65536?(s[1]+=126,s.writeUInt16BE(i,2),n+=2):(s[1]+=127,s.writeUInt32BE(Math.floor(i/Math.pow(2,32)),2),s.writeUInt32BE(i%Math.pow(2,32),6),n+=8),r){for(a=Buffer.alloc(4),h=0;h<4;h++)s[n+h]=a[h]=Math.floor(256*Math.random());for(h=0;h<o.length;h++)o[h]^=a[h%4];n+=4}return s}t.createTextFrame=function(e,t){var o,i;return i=r(!0,1,void 0!==t&&t,o=Buffer.from(e)),Buffer.concat([i,o],i.length+o.length)},t.createBinaryFrame=function(e,t,o,i){var s,n;return o=void 0===o||o,(t=void 0!==t&&t)?(s=Buffer.alloc(e.length),e.copy(s)):s=e,n=r(void 0===i||i,o?2:0,t,s),Buffer.concat([n,s],n.length+s.length)},t.createCloseFrame=function(e,t,o){var i,s;return void 0!==e&&1005!==e?(i=Buffer.from(void 0===t?"--":"--"+t)).writeUInt16BE(e,0):i=Buffer.alloc(0),s=r(!0,8,void 0!==o&&o,i),Buffer.concat([s,i],s.length+i.length)},t.createPingFrame=function(e,t){var o,i;return i=r(!0,9,void 0!==t&&t,o=Buffer.from(e)),Buffer.concat([i,o],i.length+o.length)},t.createPongFrame=function(e,t){var o,i;return i=r(!0,10,void 0!==t&&t,o=Buffer.from(e)),Buffer.concat([i,o],i.length+o.length)}},86:(e,t,r)=>{"use strict";var o=r(243),i=r(145),s=r(808),n=r(404),a=r(310);t.createServer=function(e,t){return"function"!=typeof e&&arguments.length?new o(Boolean(e.secure),e,t):new o(!1,e)},t.connect=function(e,t,r){var o;"function"==typeof t&&(r=t,t=void 0),t=t||{};var h=function(e){var t,r;if((t=a.parse(e)).protocol=t.protocol||"ws:","ws:"===t.protocol)r=!1;else{if("wss:"!==t.protocol)throw new Error("Invalid protocol "+t.protocol+". It must be ws or wss");r=!0}return t.port=t.port||(r?443:80),t.path=t.path||"/",{path:t.path,port:t.port,secure:r,host:t.hostname}}(e);return t.port=h.port,t.host=h.host,h.extraHeaders=t.extraHeaders,h.protocols=t.protocols,o=h.secure?n.connect(t):s.connect(t),new i(o,h,r)},t.setBinaryFragmentation=function(e){i.binaryFragmentation=e},t.setMaxBufferLength=function(e){i.maxBufferLength=e}},113:e=>{"use strict";e.exports=require("crypto")},361:e=>{"use strict";e.exports=require("events")},808:e=>{"use strict";e.exports=require("net")},781:e=>{"use strict";e.exports=require("stream")},404:e=>{"use strict";e.exports=require("tls")},310:e=>{"use strict";e.exports=require("url")},837:e=>{"use strict";e.exports=require("util")}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,r),s.exports}(()=>{const e=r(86);console.log(e,"ws"),global.ws=e})()})();